import{z as e}from"./vendor-amplify--Mqz53-D.js";import{a as s,u as t,L as a}from"./vendor-react-BcQzlVW4.js";import{c as r}from"./index-DdKmiHhW.js";import{S as l,E as n,P as o,a as i,C as c,T as d,b as u,c as m,d as x,X as g}from"./vendor-icons-BYRHc9LL.js";import{C as h}from"./ConfirmDialog-BVTJzjAX.js";const p=({onSelectExercise:t,onCreateCustom:a})=>{const{exercises:r,loading:i,error:c,searchExercises:d}=(()=>{const[e,t]=s.useState([]),[a,r]=s.useState(!0),[l,n]=s.useState(null);s.useEffect(()=>{o()},[]);const o=async()=>{try{const e=await fetch("/exercise-database.txt");if(!e.ok)throw new Error("Failed to load exercise database");const s=await e.text(),a=i(s);t(a)}catch(e){n(e instanceof Error?e.message:"Unknown error")}finally{r(!1)}},i=e=>e.split("\n").filter(e=>e.trim()&&!e.startsWith("#")).map(e=>{const[s,t]=e.split(": ");return{name:(null==s?void 0:s.trim())||"",youtubeUrl:(null==t?void 0:t.trim())||""}}).filter(e=>e.name&&e.youtubeUrl);return{exercises:e,loading:a,error:l,searchExercises:s=>{if(!s)return e;const t=s.toLowerCase();return e.filter(e=>e.name.toLowerCase().includes(t))},addExerciseToDatabase:async e=>{t(s=>[...s,e])},reloadDatabase:o}})(),[u,m]=s.useState(""),[x,g]=s.useState([]),[h,p]=s.useState(!1);return s.useEffect(()=>{g(d(u))},[u,r]),i?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading exercise database..."})]}):c?e.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[e.jsxs("p",{className:"text-yellow-800",children:["Could not load exercise database: ",c]}),e.jsx("button",{onClick:a,className:"mt-2 text-blue-600 hover:text-blue-800 underline",children:"Add exercise manually instead"})]}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:u,onChange:e=>{m(e.target.value),p(!0)},onFocus:()=>p(!0),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search for an exercise..."})]}),h&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:x.length>0?e.jsxs(e.Fragment,{children:[x.map((s,a)=>e.jsx("button",{onClick:()=>{t(s),m(""),p(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.name}),e.jsx(n,{className:"h-4 w-4 text-gray-400"})]})},a)),e.jsxs("button",{onClick:()=>{a(),p(!1)},className:"w-full px-4 py-3 text-left text-blue-600 hover:bg-blue-50 border-t-2 border-blue-100 flex items-center",children:[e.jsx(o,{className:"h-4 w-4 mr-2"}),"Create custom exercise"]})]}):u?e.jsxs("div",{className:"px-4 py-3",children:[e.jsxs("p",{className:"text-gray-500 mb-2",children:['No exercises found for "',u,'"']}),e.jsxs("button",{onClick:()=>{a(),p(!1)},className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx(o,{className:"h-4 w-4 mr-2"}),'Create "',u,'" as custom exercise']})]}):e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"Start typing to search exercises..."}),e.jsxs("p",{className:"text-sm text-gray-400",children:[r.length," exercises available"]})]})}),h&&e.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>p(!1)})]})},b=()=>{const{id:l}=t(),[n,d]=s.useState(null),[u,m]=s.useState([]),[x,g]=s.useState(!0),[p,b]=s.useState(!1),[j,w]=s.useState(null),[N,v]=s.useState({isOpen:!1,type:"workout",item:null,title:"",message:""}),[k,S]=s.useState({name:"",dayOfWeek:1});s.useEffect(()=>{l&&C()},[l]);const C=async()=>{try{const e=await r.models.Program.get({id:l});d(e.data);const s=await r.models.Workout.list({filter:{programId:{eq:l}}});m(s.data.sort((e,s)=>e.dayOfWeek-s.dayOfWeek))}catch(e){}finally{g(!1)}},E=async e=>{const s=await r.models.ExerciseWeekConfig.list({filter:{exerciseId:{eq:e.id}}});for(const a of s.data)await r.models.ExerciseWeekConfig.delete({id:a.id});const t=await r.models.ExerciseLog.list({filter:{exerciseId:{eq:e.id}}});for(const a of t.data){const e=await r.models.SetLog.list({filter:{exerciseLogId:{eq:a.id}}});for(const s of e.data)await r.models.SetLog.delete({id:s.id});await r.models.ExerciseLog.delete({id:a.id})}await r.models.Exercise.delete({id:e.id})};return x?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):n?e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(a,{to:"/",className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),"Back to Programs"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:n.name}),e.jsxs("p",{className:"text-gray-600 mt-2",children:[n.durationWeeks," weeks • Currently on week ",n.currentWeek||1]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"h-5 w-5 text-gray-500"}),e.jsx("select",{value:n.currentWeek||1,onChange:e=>(async e=>{if(n)try{await r.models.Program.update({id:n.id,currentWeek:e}),d({...n,currentWeek:e})}catch(s){}})(parseInt(e.target.value)),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Array.from({length:n.durationWeeks},(s,t)=>e.jsxs("option",{value:t+1,children:["Week ",t+1]},t+1))})]})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[u.map(s=>e.jsx(f,{workout:s,program:n,onEdit:()=>w(s),onDelete:()=>v({isOpen:!0,type:"workout",item:s,title:"Delete Workout",message:`Are you sure you want to delete "${s.name}"? This will permanently delete all exercises and logged data for this workout. This action cannot be undone.`})},s.id)),e.jsxs("div",{onClick:()=>b(!0),className:"bg-white rounded-lg shadow-md border-2 border-dashed border-gray-300 hover:border-blue-400 transition-colors p-6 flex flex-col items-center justify-center cursor-pointer text-gray-500 hover:text-blue-600",children:[e.jsx(o,{className:"h-12 w-12 mb-2"}),e.jsx("span",{className:"text-lg font-medium",children:"Add Workout"})]})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add New Workout"}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await r.models.Workout.create({programId:l,name:k.name,dayOfWeek:k.dayOfWeek}),S({name:"",dayOfWeek:1}),b(!1),C()}catch(s){}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Workout Name"}),e.jsx("input",{type:"text",required:!0,value:k.name,onChange:e=>S(s=>({...s,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Upper Body, Push Day"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Day of Week"}),e.jsx("select",{value:k.dayOfWeek,onChange:e=>S(s=>({...s,dayOfWeek:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[1,2,3,4,5].map(s=>e.jsxs("option",{value:s,children:["Day ",s]},s))})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors",children:"Create Workout"}),e.jsx("button",{type:"button",onClick:()=>b(!1),className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-md transition-colors",children:"Cancel"})]})]})]})}),j&&e.jsx(y,{workout:j,program:n,onClose:()=>w(null),onExerciseDelete:e=>v({isOpen:!0,type:"exercise",item:e,title:"Delete Exercise",message:`Are you sure you want to delete "${e.name}"? This will permanently delete all configurations and logged data for this exercise. This action cannot be undone.`})}),e.jsx(h,{isOpen:N.isOpen,title:N.title,message:N.message,confirmText:"workout"===N.type?"Delete Workout":"Delete Exercise",onConfirm:async()=>{N.item&&("workout"===N.type?await(async e=>{try{const s=await r.models.Exercise.list({filter:{workoutId:{eq:e.id}}});for(const e of s.data)await E(e);await r.models.Workout.delete({id:e.id}),m(u.filter(s=>s.id!==e.id)),v({isOpen:!1,type:"workout",item:null,title:"",message:""})}catch(s){alert("Failed to delete workout. Please try again.")}})(N.item):(await E(N.item),j&&w({...j})))},onCancel:()=>v({isOpen:!1,type:"workout",item:null,title:"",message:""}),dangerous:!0})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Program not found"}),e.jsx(a,{to:"/",className:"text-blue-600 hover:text-blue-800 mt-4 inline-block",children:"← Back to Programs"})]})},f=({workout:t,program:l,onEdit:n,onDelete:o})=>{const[i,c]=s.useState(0);s.useEffect(()=>{g()},[t.id]);const g=async()=>{try{const e=await r.models.Exercise.list({filter:{workoutId:{eq:t.id}}});c(e.data.length)}catch(e){}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-600 relative group",children:[e.jsx("button",{onClick:o,className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 rounded-full text-red-500 hover:text-red-700",title:"Delete Workout",children:e.jsx(d,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"pr-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-gray-600",children:["Day ",t.dayOfWeek]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[i," exercises"]})]}),e.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(u,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(a,{to:`/workout/${l.id}/${t.id}/${l.currentWeek||1}`,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white text-center py-2 px-4 rounded-md transition-colors flex items-center justify-center",children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),"Start Workout"]}),e.jsx("button",{onClick:n,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-4 rounded-md transition-colors",children:e.jsx(x,{className:"h-4 w-4"})})]})]})},y=({workout:t,program:a,onClose:l,onExerciseDelete:o})=>{const[i,c]=s.useState([]),[u,m]=s.useState(!1),[x,h]=s.useState(!1),[b,f]=s.useState([{name:"",youtubeUrl:""}]),[y,j]=s.useState({name:"",youtubeUrl:"",workingSets:3,warmupSets:0,repRange:"8-12",earlySetRPE:7,lastSetRPE:9,restSeconds:120,notes:"",lastSetIntensityTechnique:""});s.useEffect(()=>{w()},[t.id]);const w=async()=>{try{const e=await r.models.Exercise.list({filter:{workoutId:{eq:t.id}}}),s=await Promise.all(e.data.sort((e,s)=>e.orderIndex-s.orderIndex).map(async e=>{const s=await r.models.ExerciseWeekConfig.list({filter:{exerciseId:{eq:e.id},weekNumber:{eq:a.currentWeek||1}}});return{...e,weekConfig:s.data[0]}}));c(s)}catch(e){}},N=e=>{const s=Math.floor(e/60),t=e%60;return t>0?`${s}:${t.toString().padStart(2,"0")}`:`${s}:00`},v=e=>{if(!e)return[];try{return JSON.parse(e)}catch{return e.split(",").map(e=>({name:e.trim(),youtubeUrl:""}))}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold",children:[t.name," - Exercises"]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"✕"})]}),e.jsx("div",{className:"space-y-4 mb-6",children:i.map((s,t)=>{var a;return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 relative group",children:[e.jsx("button",{onClick:()=>o(s),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 rounded-full text-red-500 hover:text-red-700",title:"Delete Exercise",children:e.jsx(d,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 pr-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 text-sm px-2 py-1 rounded-full font-medium",children:t+1}),s.youtubeUrl?e.jsxs("a",{href:s.youtubeUrl,target:"_blank",rel:"noopener noreferrer",className:"text-lg font-semibold text-blue-600 hover:text-blue-800 flex items-center",children:[s.name,e.jsx(n,{className:"h-4 w-4 ml-1"})]}):e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:s.name})]}),s.weekConfig&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Sets:"})," ",s.weekConfig.warmupSets?`${s.weekConfig.warmupSets}W + `:"",s.weekConfig.workingSets]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Reps:"})," ",s.weekConfig.reps]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"RPE:"})," ",s.weekConfig.earlySetRPE,"-",s.weekConfig.lastSetRPE]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rest:"})," ",s.weekConfig.restSeconds?N(s.weekConfig.restSeconds):"N/A"]}),s.weekConfig.lastSetIntensityTechnique&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"font-medium",children:"Technique:"})," ",s.weekConfig.lastSetIntensityTechnique]}),s.weekConfig.notes&&e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",s.weekConfig.notes]})]}),(null==(a=s.weekConfig)?void 0:a.substitutionOptions)&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-medium text-sm text-gray-700",children:"Substitutions:"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:v(s.weekConfig.substitutionOptions).map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg px-3 py-1 border border-gray-200",children:s.youtubeUrl?e.jsxs("a",{href:s.youtubeUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm flex items-center",children:[s.name,e.jsx(n,{className:"h-3 w-3 ml-1"})]}):e.jsx("span",{className:"text-sm text-gray-700",children:s.name})},t))})]})]})})]},s.id)})}),u?e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=await r.models.Exercise.create({workoutId:t.id,name:y.name,youtubeUrl:y.youtubeUrl||void 0,orderIndex:i.length}),s=b.filter(e=>""!==e.name.trim()),l=s.length>0?JSON.stringify(s):void 0;for(let t=1;t<=a.durationWeeks;t++)await r.models.ExerciseWeekConfig.create({exerciseId:e.data.id,weekNumber:t,workingSets:y.workingSets,warmupSets:y.warmupSets,reps:y.repRange,earlySetRPE:y.earlySetRPE,lastSetRPE:y.lastSetRPE,restSeconds:y.restSeconds,notes:y.notes||void 0,lastSetIntensityTechnique:y.lastSetIntensityTechnique||void 0,substitutionOptions:l});j({name:"",youtubeUrl:"",workingSets:3,warmupSets:0,repRange:"8-12",earlySetRPE:7,lastSetRPE:9,restSeconds:120,notes:"",lastSetIntensityTechnique:""}),f([{name:"",youtubeUrl:""}]),m(!1),h(!1),w()}catch(s){}},className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:x?"Create Custom Exercise":`Configure: ${y.name}`}),e.jsx("button",{type:"button",onClick:()=>{m(!1),h(!1),j({name:"",youtubeUrl:"",workingSets:3,warmupSets:0,repRange:"8-12",earlySetRPE:7,lastSetRPE:9,restSeconds:120,notes:"",lastSetIntensityTechnique:""})},className:"text-gray-400 hover:text-gray-600",children:e.jsx(g,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{type:"text",required:!0,value:y.name,onChange:e=>j(s=>({...s,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Exercise name"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{type:"url",value:y.youtubeUrl,onChange:e=>j(s=>({...s,youtubeUrl:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"YouTube URL (optional)"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Working Sets"}),e.jsx("input",{type:"number",min:"1",max:"10",required:!0,value:y.workingSets,onChange:e=>j(s=>({...s,workingSets:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warmup Sets"}),e.jsx("input",{type:"number",min:"0",max:"5",value:y.warmupSets,onChange:e=>j(s=>({...s,warmupSets:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rep Range"}),e.jsx("input",{type:"text",required:!0,value:y.repRange,onChange:e=>j(s=>({...s,repRange:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 8-12"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rest Time"}),e.jsxs("select",{value:y.restSeconds,onChange:e=>j(s=>({...s,restSeconds:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:60,children:"1:00"}),e.jsx("option",{value:90,children:"1:30"}),e.jsx("option",{value:120,children:"2:00"}),e.jsx("option",{value:150,children:"2:30"}),e.jsx("option",{value:180,children:"3:00"}),e.jsx("option",{value:240,children:"4:00"}),e.jsx("option",{value:300,children:"5:00"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-colors",children:"Add Exercise"}),e.jsx("button",{type:"button",onClick:()=>{m(!1),h(!1)},className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md transition-colors",children:"Back to Search"})]})]}):e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add Exercise"}),e.jsx(p,{onSelectExercise:e=>{j(s=>({...s,name:e.name,youtubeUrl:e.youtubeUrl})),m(!0),h(!1)},onCreateCustom:()=>{h(!0),m(!0)}})]})]})})};export{b as default};
